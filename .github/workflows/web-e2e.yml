# E2E ãƒ†ã‚¹ãƒˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
#
# apps/web/ ã¾ãŸã¯ packages/ui/ é…ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¤‰æ›´ã•ã‚ŒãŸ PR ã§è‡ªå‹•å®Ÿè¡Œã•ã‚Œã‚‹ã€‚
# Next.js ã‚¢ãƒ—ãƒªã‚’ãƒ“ãƒ«ãƒ‰ã—ã€Playwright ã§ãƒšãƒ¼ã‚¸é·ç§»ã‚„ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–è¡¨ç¤ºãªã©ã‚’æ¤œè¨¼ã™ã‚‹ã€‚
# PR æ™‚ã¯ãƒ™ãƒ¼ã‚¹ãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã‚’å‹•çš„ç”Ÿæˆã—ã€reg-cli ã§å·®åˆ†ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã€‚
name: E2E Tests

on:
  pull_request:
    branches: [main]
    # apps/web/ ã¨ packages/ui/ ã®å¤‰æ›´æ™‚ã«å®Ÿè¡Œ
    # UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å¤‰æ›´ãŒ Web ã‚¢ãƒ—ãƒªã«å½±éŸ¿ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ä¸¡æ–¹ã‚’ç›£è¦–
    paths:
      - "apps/web/**"
      - "packages/ui/**"
  workflow_dispatch:

permissions:
  actions: read
  contents: write
  pull-requests: write

# ãƒ¬ãƒãƒ¼ãƒˆã®å‡ºåŠ›å…ˆãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹
# PR æ™‚: pr/{PRç•ªå·}  ï¼ˆä¾‹: pr/42ï¼‰
# æ‰‹å‹•å®Ÿè¡Œæ™‚: manual/{å®Ÿè¡ŒID}  ï¼ˆä¾‹: manual/12345ï¼‰
env:
  REPORT_PREFIX: ${{ github.event.pull_request.number && format('pr/{0}', github.event.pull_request.number) || format('manual/{0}', github.run_id) }}

jobs:
  test:
    name: "\U0001F9EA E2E Test Report"
    runs-on: ubuntu-latest
    timeout-minutes: 15
    outputs:
      vrt-table: ${{ steps.reg-result.outputs.vrt-table }}
    steps:
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

      - uses: actions/checkout@v6
        with:
          # ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ç”Ÿæˆã§ base branch ã‚’å‚ç…§ã™ã‚‹ãŸã‚å…¨å±¥æ­´ãŒå¿…è¦
          fetch-depth: 0

      # bun ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ï¼‰
      - uses: oven-sh/setup-bun@v2
        with:
          bun-version: latest

      # Playwright ãƒ–ãƒ©ã‚¦ã‚¶ãƒã‚¤ãƒŠãƒªã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆChromium ã®ã¿ï¼‰
      # ã‚­ãƒ¼ã« Playwright ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å«ã‚ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ›´æ–°æ™‚ã«è‡ªå‹•ã§å†ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹
      - name: Get Playwright version
        id: pw-version
        run: echo "version=$(bunx playwright --version | awk '{print $2}')" >> $GITHUB_OUTPUT

      - name: Cache Playwright browsers
        id: pw-cache
        uses: actions/cache@v5
        with:
          path: ~/.cache/ms-playwright
          key: playwright-${{ runner.os }}-${{ steps.pw-version.outputs.version }}

      - name: Install Playwright browsers
        if: steps.pw-cache.outputs.cache-hit != 'true'
        run: bunx playwright install --with-deps chromium

      # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆæ™‚ã‚‚ã‚·ã‚¹ãƒ†ãƒ ä¾å­˜ï¼ˆlibgbm ç­‰ï¼‰ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯å¿…è¦
      - name: Install Playwright system dependencies
        if: steps.pw-cache.outputs.cache-hit == 'true'
        run: bunx playwright install-deps chromium

      # ãƒ¢ãƒãƒ¬ãƒå…¨ä½“ã®ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆlockfile ã‚’å³å¯†ã«ä½¿ç”¨ï¼‰
      - name: Install dependencies
        run: bun install --frozen-lockfile

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ç”Ÿæˆ â†’ ãƒ“ãƒ«ãƒ‰ â†’ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

      # PR æ™‚ã®ã¿: ãƒ™ãƒ¼ã‚¹ãƒ–ãƒ©ãƒ³ãƒã®ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’ç”Ÿæˆã—ã€
      # .reg/expected/ ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Š reg-cli ã§å·®åˆ†æ¯”è¼ƒãŒå¯èƒ½ã«ãªã‚‹ã€‚
      # git worktree ã‚’ä½¿ã£ã¦åˆ¥ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ™ãƒ¼ã‚¹ãƒ–ãƒ©ãƒ³ãƒã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã—ã€
      # ãã“ã§ãƒ“ãƒ«ãƒ‰ï¼†ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’å–å¾—ã™ã‚‹ã€‚
      - name: Generate baselines from base branch
        if: github.event_name == 'pull_request'
        run: |
          BASE_REF="${{ github.event.pull_request.base.ref }}"
          git worktree add /tmp/baseline "origin/${BASE_REF}" --detach
          cd /tmp/baseline
          bun install --frozen-lockfile
          cd apps/web
          bun run build
          bunx playwright test || true
          mkdir -p $GITHUB_WORKSPACE/apps/web/.reg/expected/
          cp -r .reg/actual/* $GITHUB_WORKSPACE/apps/web/.reg/expected/ || true
          cd $GITHUB_WORKSPACE
          git worktree remove /tmp/baseline --force

      # ç¾åœ¨ã®ãƒ–ãƒ©ãƒ³ãƒã§ Next.js ãƒ“ãƒ«ãƒ‰
      - name: Build
        run: bun run build
        working-directory: apps/web

      # Playwright ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆãƒšãƒ¼ã‚¸é·ç§»ãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–æ¤œè¨¼ï¼‰
      # ãƒ†ã‚¹ãƒˆçµæœã¯ playwright-report/ ã¨ allure-results/ ã«å‡ºåŠ›ã•ã‚Œã‚‹
      - name: Run Playwright tests
        run: bunx playwright test
        working-directory: apps/web
        env:
          CI: true

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

      # GitHub Pages ã‹ã‚‰ Allure å±¥æ­´ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆJSONLï¼‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚
      # Allure Report v3 ã§ã¯ history/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ã¯ãªãå˜ä¸€ã® JSONL ãƒ•ã‚¡ã‚¤ãƒ«ã§å±¥æ­´ã‚’ç®¡ç†ã™ã‚‹ã€‚
      # åˆå›å®Ÿè¡Œæ™‚ã‚„ãƒšãƒ¼ã‚¸æœªãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã¯ 404 ã«ãªã‚‹ãŒã€|| true ã§ç„¡è¦–ã™ã‚‹ã€‚
      - name: Download previous Allure history
        if: always()
        run: |
          PAGES_BASE="https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}"
          HISTORY_URL="${PAGES_BASE}/latest/web-e2e/allure-history.jsonl"
          curl -sSfL "${HISTORY_URL}" -o "allure-history.jsonl" || true
        working-directory: apps/web

      # allure-results/ ã‹ã‚‰ Allure ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆï¼ˆãƒªãƒƒãƒãªãƒ†ã‚¹ãƒˆçµæœãƒ“ãƒ¥ãƒ¼ã‚¢ï¼‰
      # --history-path ã§ JSONL å±¥æ­´ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã™ã‚‹ã¨ã€ãƒˆãƒ¬ãƒ³ãƒ‰ã‚°ãƒ©ãƒ•ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚
      # appendHistoryï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ trueï¼‰ã«ã‚ˆã‚Šç¾åœ¨ã®å®Ÿè¡ŒçµæœãŒå±¥æ­´ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½è¨˜ã•ã‚Œã‚‹ã€‚
      - name: Generate Allure report
        if: always()
        run: |
          HISTORY_OPT=""
          if [ -f allure-history.jsonl ]; then
            HISTORY_OPT="--history-path allure-history.jsonl"
          fi
          rm -rf allure-report && bunx allure generate allure-results -o allure-report $HISTORY_OPT
        working-directory: apps/web

      # reg-cli: .reg/expected/ï¼ˆãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ï¼‰ã¨ .reg/actual/ï¼ˆç¾åœ¨ï¼‰ã‚’æ¯”è¼ƒã—ã€
      # å·®åˆ†ãƒ¬ãƒãƒ¼ãƒˆã‚’ .reg/ ã«ç”Ÿæˆã™ã‚‹ã€‚çµæœã‚µãƒãƒªãƒ¼ã¯ PR ã‚³ãƒ¡ãƒ³ãƒˆç”¨ã« GITHUB_OUTPUT ã«å‡ºåŠ›ã€‚
      - name: Run reg-cli comparison
        if: always()
        id: reg-result
        run: |
          bun run e2e:report:reg || true

          # .reg/out.json ã‹ã‚‰å„ã‚«ãƒ†ã‚´ãƒªã®ä»¶æ•°ã‚’å–å¾—
          CHANGED=$(jq '.diffItems | length' .reg/out.json)
          PASSED=$(jq '.passedItems | length' .reg/out.json)
          NEW=$(jq '.newItems | length' .reg/out.json)
          DELETED=$(jq '.deletedItems | length' .reg/out.json)

          # PR ã‚³ãƒ¡ãƒ³ãƒˆç”¨ã®ã‚µãƒãƒªãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’çµ„ã¿ç«‹ã¦ï¼ˆreg-cli ãƒ¬ãƒãƒ¼ãƒˆã¨åŒã˜é †åºã€ä»¶æ•° 0 ã¯çœç•¥ï¼‰
          VRT_TABLE="| Status | Count |
          |--------|-------|"
          [ "$CHANGED" -gt 0 ] && VRT_TABLE="$VRT_TABLE
          | âš ï¸ Changed | $CHANGED |"
          [ "$NEW" -gt 0 ] && VRT_TABLE="$VRT_TABLE
          | ğŸ†• New | $NEW |"
          [ "$DELETED" -gt 0 ] && VRT_TABLE="$VRT_TABLE
          | ğŸ—‘ï¸ Deleted | $DELETED |"
          [ "$PASSED" -gt 0 ] && VRT_TABLE="$VRT_TABLE
          | âœ… Passed | $PASSED |"

          # GITHUB_OUTPUT ã«ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§å‡ºåŠ›ï¼ˆè¤‡æ•°è¡Œå¯¾å¿œï¼‰
          echo "vrt-table<<EOF" >> $GITHUB_OUTPUT
          echo "$VRT_TABLE" >> $GITHUB_OUTPUT
          echo "EOF" >> $GITHUB_OUTPUT
        working-directory: apps/web

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼†ãƒ‡ãƒ—ãƒ­ã‚¤
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

      # ãƒ†ã‚¹ãƒˆå¤±æ•—æ™‚ã®ã¿: ãƒ‡ãƒãƒƒã‚°ç”¨ã«ãƒ†ã‚¹ãƒˆçµæœï¼ˆã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãƒ»ãƒˆãƒ¬ãƒ¼ã‚¹ç­‰ï¼‰ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
      - name: Upload test results
        if: failure()
        uses: actions/upload-artifact@v6
        with:
          name: web-e2e-report
          path: apps/web/test-results/
          retention-days: 30

      # Playwright æ¨™æº–ã® HTML ãƒ¬ãƒãƒ¼ãƒˆã‚’ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã¨ã—ã¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
      - name: Upload HTML report
        if: always()
        uses: actions/upload-artifact@v6
        with:
          name: web-e2e-html-report
          path: apps/web/playwright-report/
          retention-days: 30

      # Allure ãƒ¬ãƒãƒ¼ãƒˆã‚’ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã¨ã—ã¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
      - name: Upload Allure report
        if: always()
        uses: actions/upload-artifact@v6
        with:
          name: web-e2e-allure-report
          path: apps/web/allure-report/
          retention-days: 30

      # å…¨ãƒ¬ãƒãƒ¼ãƒˆã‚’1ã¤ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¾ã¨ã‚ã€1å›ã® push ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã€‚
      # keep_files: true ã§æ—¢å­˜ã®ãƒ¬ãƒãƒ¼ãƒˆã‚’ä¿æŒã™ã‚‹ï¼ˆä»–ã® PR ã®ãƒ¬ãƒãƒ¼ãƒˆã‚’æ¶ˆã•ãªã„ï¼‰
      - name: Stage reports for GitHub Pages
        if: always()
        run: |
          DEST="${{ env.REPORT_PREFIX }}/web-e2e"
          mkdir -p _gh-pages-staging/${DEST}/html-report
          mkdir -p _gh-pages-staging/${DEST}/allure-report
          mkdir -p _gh-pages-staging/${DEST}/reg-report
          cp -r playwright-report/* _gh-pages-staging/${DEST}/html-report/ || true
          cp -r allure-report/* _gh-pages-staging/${DEST}/allure-report/ || true
          cp -r .reg/* _gh-pages-staging/${DEST}/reg-report/ || true

          # Allure å±¥æ­´ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆJSONLï¼‰ã‚’å…±æœ‰ãƒ‘ã‚¹ã«ã‚³ãƒ”ãƒ¼ï¼ˆå…¨ PR ã§å±¥æ­´ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ï¼‰
          if [ -f allure-history.jsonl ]; then
            mkdir -p _gh-pages-staging/latest/web-e2e
            cp allure-history.jsonl _gh-pages-staging/latest/web-e2e/allure-history.jsonl
          fi
        working-directory: apps/web

      # deploy ã‚¸ãƒ§ãƒ–ã«æ¸¡ã™ãŸã‚ã®ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°æ¸ˆã¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä¸€å¼ï¼‰
      - name: Upload deploy payload
        if: always()
        uses: actions/upload-artifact@v6
        with:
          name: web-e2e-deploy-payload
          path: apps/web/_gh-pages-staging/
          retention-days: 1

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆgh-pages ã¸ã® push ã®ã¿ç›´åˆ—åŒ–ï¼‰
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  deploy:
    name: "Deploy \U0001F9EA E2E Test Report"
    needs: test
    if: ${{ !cancelled() }}
    runs-on: ubuntu-latest
    timeout-minutes: 5
    # gh-pages ãƒ–ãƒ©ãƒ³ãƒã¸ã® push ãŒç«¶åˆã—ãªã„ã‚ˆã†ã«ã‚­ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚°
    concurrency:
      group: gh-pages-deploy
      cancel-in-progress: false
    steps:
      - name: Download deploy payload
        uses: actions/download-artifact@v6
        with:
          name: web-e2e-deploy-payload
          path: _gh-pages-staging/

      - name: Deploy reports to GitHub Pages
        uses: peaceiris/actions-gh-pages@v4
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: _gh-pages-staging
          keep_files: true

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # PR ã‚³ãƒ¡ãƒ³ãƒˆ
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

      # sticky-pull-request-comment: åŒã˜ header ã®ã‚³ãƒ¡ãƒ³ãƒˆãŒã‚ã‚Œã°æ›´æ–°ã€ãªã‘ã‚Œã°æ–°è¦ä½œæˆ
      # å„ãƒ¬ãƒãƒ¼ãƒˆã® GitHub Pages URL ã¨ reg-cli ã®å·®åˆ†ã‚µãƒãƒªãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹
      - name: Comment PR with report links
        if: always()
        uses: marocchino/sticky-pull-request-comment@v2
        with:
          header: web-e2e-report
          message: |
            ## ğŸ§ª E2E Test Report

            ${{ needs.test.outputs.vrt-table }}

            | Report | Link |
            |--------|------|
            | reg-cli | https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/${{ env.REPORT_PREFIX }}/web-e2e/reg-report/report/ |
            | Playwright HTML | https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/${{ env.REPORT_PREFIX }}/web-e2e/html-report/ |
            | Allure | https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/${{ env.REPORT_PREFIX }}/web-e2e/allure-report/ |

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³å¯è¦–åŒ–
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  actions-timeline:
    name: Actions Timeline
    needs: [test, deploy]
    if: ${{ !cancelled() }}
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
      - uses: Kesin11/actions-timeline@v3
